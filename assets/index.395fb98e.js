import{_ as b,r as y,o as d,c as v,b as r,t as _,d as g,p as E,q as M,i as I,F as j,h as O,k as S}from"./index.9ee9ee7b.js";let f={};const T={align:"center",isMove:!0,x:0,y:0,iconId:"",url:"/images/love.png",data:[],callback:{},element:void 0};class N{constructor(t,e={}){this.krpano=t,this.option=e}register(t,e={}){return this.option={...this.option,...e},f[t]?f[t]:new P(t,this.option,this.krpano)}switch(t){this.krpano.hotspot.getArray().forEach(e=>{e.hotspot_type&&(e.visible=t)})}getHotspots(){return this.krpano.hotspot.getArray()}onremovepano(){for(var t in f)f[t].hotspotList=[]}finishData(t){return H(t)}finishDataList(t){for(var e in t)t[e]=H(t[e]);return t}}class P{constructor(t,e={},o){if(this.hotspotType=t,this.option=e,this.krpano=o,this.hotspotList=[],console.log("RegisterHotspot",this.krpano),!t)return console.error("\u5FC5\u987B\u8F93\u5165hotspotType");e.data&&this.init(e)}init(t){const e=t.data;t.data=void 0;for(var o in e)this.addHotspot($.extend(!0,{data:{}},t,e[o],{callback:{onAddHotspot:function(){}}}))}addHotspot(t={}){let e;return t.hotspotType=this.hotspotType,t=$.extend(!0,{},T,this.option,t),e=new R(this.krpano,t),this.hotspotList.push(e),e}getHotspot(t){var e=this.hotspotList,o;if(t){for(o in e)if(t==e[o].name)return e[o];return console.error("\u672A\u627E\u5230\u70ED\u70B9\uFF0Cname=",t)}return e}}class R{constructor(t,e={}){this.option=e,this.krpano=t,this.init()}init(){var t=this,e=this.option||{};console.log("opt",e);var o=this.krpano,a=e.ath||0,i=e.atv||0,s;if(!e.name)do this.name="flying_"+Math.random().toString(36).substring(2);while(o.get("hotspot["+this.name+"]"));if(!a&&a!==0&&!a&&a!==0){o.call("adjusthlookat(view.hlookat)"),a=o.view.hlookat,i=o.view.vlookat,o.spheretoscreen(o.view.hlookat,o.view.vlookat);var p=e.x||0,c=e.y||0;if(p||c){var m=o.screentosphere(p,c);a=m.x,i=m.y}}else a=a||0,i=i||0;typeof e.element=="function"?this.element=$(e.element(e.data)):this.element=$(e.element).clone(!0),this.data=e.data||{};var s=this.hotspot=o.addhotspot(this.name);if(s.keep=!0,s.align=e.align,s.ath=a,s.atv=i,s.hotspot_type=e.hotspotType,s.capture=!0,s.scale=.5,e.iconId?w(this,e.iconId):s.url=e.url,this.element){var A="layer_"+this.name,l=t.layer=o.addlayer(A);l.type="container",l.keep=!0,l.align="right",l.edge="left",$(l.sprite).append(this.element),$(l.sprite).delegate(":text, textarea","click mousedown mousedown focus",function(h){h.stopPropagation()}),$(l.sprite).delegate(".move","mousedown touchstart",function(h){s.ondown(),$(document).on("mouseup touchend",function(Y){s.onup(),$(document).off("mouseup touchend")})}),$(l.sprite).delegate(".click","click",function(h){return h.preventDefault(),s.onclick(),!1}),$(l.sprite).delegate(".click",{touchstart:function(h){s.isClick=!0},touchmove:function(h){s.isClick=!1},touchend:function(){s.isClick&&s.onclick()}}),l.bgcapture=!0,l.parent="hotspot["+this.name+"]"}this.option.isMove||(s.capture=!1),u("onLoaded",t),u("onAddHotspot",t),s.onclick=k("onClick",this),s.onover=k("onOver",this),s.onout=k("onOut",this),s.onhover=k("onHover",this),s.ondown="draghotspot();",s.onup=function(){s.zorder--,u("onUp",this),this.option.isMove&&(s.dragx!=o.mouse.stagex||s.dragy!=o.mouse.stagey)&&u("onMoveUpdate",this),s.pressed=!1,s.dragx=s.dragy=0}.bind(this)}setMove(t){this.option.isMove=!!t||!this.option.isMove}setKeep(t){this.hotspot.keep=!!t,this.layer.keep=!!t}update(t){t=t||{},t.style!==void 0&&w(this,t.style),t.url&&(this.hotspot.onloaded=void 0,this.hotspot.crop=void 0,this.hotspot.style="",this.hotspot.url=t.url),t.data&&(this.data=$.extend(!0,{},this.data,t.data)),u("onUpdatestyle",this)}remove(){console.log("remove this"),this.option.krpano.removelayer(this.layer.name),this.option.krpano.removehotspot(this.name),u("onRemove",this);for(var t in f){var e=f[t].hotspotList;for(var o in e)if(e[o]===this){e.splice(o,1);break}}}zorder(t){this.hotspot.zorder=t?101+100:101}save(t){u("onSaveHotspot",this)}getData(){var t=$.extend(!0,{},{data:this.data});return t.ath=this.hotspot.ath,t.atv=this.hotspot.atv,t.iconId=parseInt(this.hotspot.iconid),t.url=this.hotspot.url,t}getOldData(){var t=$.extend(!0,{},this.data);return t.ath=this.hotspot.ath,t.atv=this.hotspot.atv,t.iconId=parseInt(this.hotspot.iconid),t.url=this.hotspot.url,t}}function w(n,t){typeof t=="object"&&(t=t.name),typeof t=="string"?n.hotspot.loadstyle(t):typeof t=="number"?n.hotspot.loadstyle(t.name):this.yp("\u672A\u627E\u5230style=",t)}function k(n,t){var e=t.option.callback[n];if(e&&typeof e=="function")return e.bind(t,t.getData())}function u(n,t){var e=t.option.callback[n];e&&typeof e=="function"&&e.call(t,t.getData())}function H(n){return{data:n,atv:n.atv,ath:n.ath,iconId:n.iconId}}const V={class:"herewrap"},B={__name:"HelloWorld",props:{msg:String},setup(n){const t=y(0);return(e,o)=>(d(),v("main",V,[r("h1",null,"--"+_(n.msg)+"++",1),o[1]||(o[1]=r("p",null,[g(" Recommended IDE setup:"),r("a",{href:"https://code.visualstudio.com/",target:"_blank"},"VSCode"),g("+"),r("a",{href:"https://github.com/johnsoncodehk/volar",target:"_blank"},"Volar")],-1)),o[2]||(o[2]=r("p",null,[r("a",{href:"https://vitejs.dev/guide/features.html",target:"_blank"},"Vite Documentation"),g("|"),r("a",{href:"https://v3.vuejs.org/",target:"_blank"},"Vue 3 Documentation")],-1)),r("button",{type:"button",onClick:o[0]||(o[0]=a=>t.value++)},"count is: "+_(t.value),1),o[3]||(o[3]=r("p",null,[g(" Edit"),r("code",null,"components/HelloWorld.vue"),g("to test hot module replacement. ")],-1))]))}};var F=b(B,[["__scopeId","data-v-043edf38"]]);function L(n,t={}){const e=n.addlayer();return t={...{name:"layer",url:"/pano/logo1.png",align:"lefttop",keep:!0,scale:1,x:20,y:20,capture:!1,bgcapture:!1,onclick:"openurl('/', _blank);"},...t},Object.keys(t).forEach(a=>{e[a]=t[a]}),e}function D(n){n.addEventListener("touchstart",function(t){t.stopPropagation()}),n.addEventListener("touchend",function(t){t.stopPropagation(),this.click()})}function x(n,{key:t,url:e}={key:"sceneTemp",url:"/pano/3.jpeg"}){if(krpano){let o=`<krpano>
          <scene name="${t}" onstart="" autoload="false" >
            <preview type="grid(sphere,16,16,512,0x666666,0x333333,0x999999);" />
            <image><sphere url="${e}" /></image>
            <view hlookat="0" vlookat="0" fov="100" distortion="0.0" />
          </scene>
        </krpano>`;return krpano.call("loadxml("+escape(o)+", null, MERGE, BLEND(0.5));"),t}}var U="/images/love.png",G='<div class="herewrap">bababa</div>',C={};const z={align:"center",isMove:!0,url:U,iconId:!1,element:G,callback:{onClick:function(){console.log("this onClick",this)},onUp:function(t){console.log("this onUp",this)},onLoaded:function(){console.log("this onLoaded",this);var n=this.element[0];E({render:()=>M(F,{msg:"hello world"})}).mount(n),D(n)},onAddHotspot:function(){C=this,console.log("this currentHotspot",C)}}};class W{constructor(t,e={}){this.option={...z,...e},this.krpano=t,this.init()}init(t){const e=new N(this.krpano,this.option);this.option.data=e.finishDataList(t),this.here=e.register("here",this.option)}addHere(t={}){this.here.addHotspot(t)}onnewscene(){console.log("this is on new scene")}}const q={key:0},K=["onClick"],Q={__name:"LogoMenu",props:{title:{type:String,default:"\u521B\u610F\u753B\u623F"},menu:{type:Array,default:()=>[]}},setup(n){const t=y(!1),e=y(null),o=a=>{console.log("item",a,x);const i=x(window.krpano,a);krpano.actions.loadscene(i)};return I(()=>{D(e.value)}),(a,i)=>(d(),v("main",{class:"logomenu",ref_key:"logomenu",ref:e},[r("h1",{onClick:i[0]||(i[0]=p=>t.value=!t.value)},_(n.title),1),t.value?(d(),v("dl",q,[(d(!0),v(j,null,O(n.menu,p=>(d(),v("dd",{key:p.name,onClick:c=>o(p)},_(p.name),9,K))),128))])):S("",!0)],512))}};var J=b(Q,[["__scopeId","data-v-2c1c4ce1"]]);const X={__name:"index",setup(n){console.log("Heres",L);const t=()=>new Promise((e,o)=>{embedpano({xml:"/krpano/krpano.xml",target:"pano",html5:"only",passQueryParameters:!0,onerror:function(a){console.log("embedpano error",a),o(a)},onready:function(a){a=a.get("global"),window.krpano=a,e(a)}})});return I(async()=>{const e=await t();console.log("krpano",e);const o=new W(e,{});o.addHere({ath:20,atv:20,url:"/images/cat.png",isMove:!0,element:"<div>haha</div>",callback:{onClick:()=>{console.log("onClick");function c(){if(e){var m=`<krpano>
              <preview type="grid(cube,64,64,512,0xCCCCCC,0xF6F6F6,0x999999);" />
              <image><sphere url="/pano/2.jpeg" /></image>
              <view hlookat="0" vlookat="0" fov="100" distortion="0.0" />
              </krpano>`;e.call("loadxml("+escape(m)+", null, MERGE, BLEND(0.5));")}}c()}}}),console.log(o),e.actions.loadpano("/test/animated-hotspots/anihotspots.xml",null,"MERGE","BLEND(0.5)");let a=L(e,{name:"logo",url:"/pano/t.png",scale:1,onclick:""});E({render:()=>M(J,{menu:[{name:"\u6D77\u5929\u4E00\u8272",key:"haitian",url:"/pano/g-cmpr.jpg"},{name:"\u6D77\u5E95\u63FD\u80DC",key:"haidi",url:"/pano/2-cmpr.jpeg"},{name:"\u95F2\u5EAD\u4FE1\u6B65",key:"xianting",url:"/pano/e-cmpr.jpg"}]})}).mount(a.sprite);var i=e.addhotspot();i.name="haha11",i.url="/images/cat.png",i.keep=!0,i.ath=0,i.atv=0,i.width=50,i.height=50,i.ondown="draghotspot();",i.onclick=function(){const c=x();e.actions.loadscene(c)},i.onout=function(){};const p=e.events.createItem("skin_plugin_vr");p.keep=!0,p.onnewscene=()=>{console.log("newnew!!")}}),(e,o)=>(d(),v("div",null,o[0]||(o[0]=[r("div",{id:"pano"},null,-1)])))}};var tt=b(X,[["__scopeId","data-v-a52b13f4"]]);export{tt as default};
