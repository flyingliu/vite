var t=Object.defineProperty,o=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(o,e,n)=>e in o?t(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,s=(t,s)=>{for(var a in s||(s={}))e.call(s,a)&&i(t,a,s[a]);if(o)for(var a of o(s))n.call(s,a)&&i(t,a,s[a]);return t};"undefined"!=typeof require&&require;import{z as a,g as r,l as h,d as l,p,f as c,s as d,o as u,h as v,i as m}from"./vendor.7a43a952.js";let f={};const g={align:"center",isMove:!0,x:0,y:0,iconId:"",url:"/images/love.png",data:[],callback:{},element:void 0};class y{constructor(t,o={}){this.krpano=t,this.option=o}register(t,o={}){this.option=s(s({},this.option),o);return f[t]?f[t]:new k(t,this.option,this.krpano)}switch(t){this.krpano.hotspot.getArray().forEach((o=>{o.hotspot_type&&(o.visible=t)}))}getHotspots(){return this.krpano.hotspot.getArray()}onremovepano(){for(var t in f)f[t].hotspotList=[]}finishData(t){return H(t)}finishDataList(t){for(var o in t)t[o]=H(t[o]);return t}}class k{constructor(t,o={},e){if(this.hotspotType=t,this.option=o,this.krpano=e,this.hotspotList=[],console.log("RegisterHotspot",this.krpano),!t)return console.error("必须输入hotspotType");o.data&&this.init(o)}init(t){const o=t.data;for(var e in t.data=void 0,o)this.addHotspot($.extend(!0,{data:{}},t,o[e],{callback:{onAddHotspot:function(){}}}))}addHotspot(t={}){let o;return t.hotspotType=this.hotspotType,t=$.extend(!0,{},g,this.option,t),o=new w(this.krpano,t),this.hotspotList.push(o),o}getHotspot(t){var o,e=this.hotspotList;if(t){for(o in e)if(t==e[o].name)return e[o];return console.error("未找到热点，name=",t)}return e}}class w{constructor(t,o={}){this.option=o,this.krpano=t,this.init()}init(){var t=this,o=this.option||{};console.log("opt",o);var e,n=this.krpano,i=o.ath||0,s=o.atv||0;if(!o.name)do{this.name="flying_"+Math.random().toString(36).substring(2)}while(n.get("hotspot["+this.name+"]"));if(i||0===i||i||0===i)i=i||0,s=s||0;else{n.call("adjusthlookat(view.hlookat)"),i=n.view.hlookat,s=n.view.vlookat,n.spheretoscreen(n.view.hlookat,n.view.vlookat);var a=o.x||0,r=o.y||0;if(a||r){var h=n.screentosphere(a,r);i=h.x,s=h.y}}if("function"==typeof o.element?this.element=$(o.element(o.data)):this.element=$(o.element).clone(!0),this.data=o.data||{},(e=this.hotspot=n.addhotspot(this.name)).keep=!0,e.align=o.align,e.ath=i,e.atv=s,e.hotspot_type=o.hotspotType,e.scale=.5,o.iconId?b(this,o.iconId):e.url=o.url,this.element){var l="layer_"+this.name,p=t.layer=n.addlayer(l);p.type="container",p.align="right",p.edge="left",$(p.sprite).append(this.element),$(p.sprite).delegate(":text, textarea","click mousedown mousedown focus",(function(t){t.stopPropagation()})),$(p.sprite).delegate(".move","mousedown touchstart",(function(t){e.ondown(),$(document).on("mouseup touchend",(function(t){e.onup(),$(document).off("mouseup touchend")}))})),$(p.sprite).delegate(".click","click",(function(t){return t.preventDefault(),e.onclick(),!1})),$(p.sprite).delegate(".click",{touchstart:function(t){e.isClick=!0},touchmove:function(t){e.isClick=!1},touchend:function(){e.isClick&&e.onclick()}}),p.bgcapture=!0,p.parent="hotspot["+this.name+"]"}this.option.isMove||(e.capture=!1),I("onLoaded",t),I("onAddHotspot",t),e.onclick=x("onClick",this),e.onover=x("onOver",this),e.onout=x("onOut",this),e.onhover=x("onHover",this),e.ondown="draghotspot();",e.onup=function(){e.zorder--,I("onUp",this),!this.option.isMove||e.dragx==n.mouse.stagex&&e.dragy==n.mouse.stagey||I("onMoveUpdate",this),e.pressed=!1,e.dragx=e.dragy=0}.bind(this)}setMove(t){this.option.isMove=!!t||!this.option.isMove}setKeep(t){this.hotspot.keep=!!t,this.layer.keep=!!t}update(t){void 0!==(t=t||{}).style&&b(this,t.style),t.url&&(this.hotspot.onloaded=void 0,this.hotspot.crop=void 0,this.hotspot.style="",this.hotspot.url=t.url),t.data&&(this.data=$.extend(!0,{},this.data,t.data)),I("onUpdatestyle",this)}remove(){for(var t in console.log("remove this"),this.option.krpano.removelayer(this.layer.name),this.option.krpano.removehotspot(this.name),I("onRemove",this),f){var o=f[t].hotspotList;for(var e in o)if(o[e]===this){o.splice(e,1);break}}}zorder(t){this.hotspot.zorder=t?201:101}save(t){I("onSaveHotspot",this)}getData(){var t=$.extend(!0,{},{data:this.data});return t.ath=this.hotspot.ath,t.atv=this.hotspot.atv,t.iconId=parseInt(this.hotspot.iconid),t.url=this.hotspot.url,t}getOldData(){var t=$.extend(!0,{},this.data);return t.ath=this.hotspot.ath,t.atv=this.hotspot.atv,t.iconId=parseInt(this.hotspot.iconid),t.url=this.hotspot.url,t}}function b(t,o){"object"==typeof o&&(o=o.name),"string"==typeof o&&funs.yp.method.icon.getIcon(o)?t.hotspot.loadstyle(o):"number"==typeof o?(o=funs.yp.method.icon.getStyle(o),t.hotspot.loadstyle(o.name)):this.yp("未找到style=",o)}function x(t,o){var e=o.option.callback[t];if(e&&"function"==typeof e)return e.bind(o,o.getData())}function I(t,o){var e=o.option.callback[t];e&&"function"==typeof e&&e.call(o,o.getData())}function H(t){return{data:t,atv:t.atv,ath:t.ath,iconId:t.iconId}}var L={props:["modelValue"],emits:["update:modelValue"],render(){return a("input",{onClick:t=>{console.log(t)},modelValue:this.modelValue,"onUpdate:modelValue":t=>this.$emit("update:modelValue",t)})}},M={setup(){r(0);const t=h({title:"Vue 3 Guide"});return()=>a("div",{class:"abc",onClick:function(){console.log("book.title",t.title,this)}},[a(L),a(L)])}},D={};const O={align:"center",isMove:!0,url:"/images/love.png",iconId:!1,element:'<div class="hotspotwrap"></div>',callback:{onClick:function(){console.log("this onClick",this)},onUp:function(t){console.log("this onUp",this)},onLoaded:function(){console.log("this onLoaded",this);var t=this.element[0];l(M).mount(t)},onAddHotspot:function(){D=this,console.log("this currentHotspot",D)}}};class C{constructor(t,o={}){this.option=s(s({},O),o),this.krpano=t,this.init()}init(t){this.option.data=this.krpano.method.hotspot.finishDataList(t),this.here=this.krpano.method.hotspot.register("here",this.option),console.log("this.here",this.here)}addHere(t={}){this.here.addHotspot(t)}onnewscene(){console.log("this is on new scene")}}p("data-v-f612385a");const _=[m("div",{id:"pano"},null,-1)];c();const j={setup:t=>(d((()=>{setTimeout((()=>{new Promise(((t,o)=>{embedpano({xml:"/test/animated-hotspots/anihotspots.xml",target:"pano",html5:"only",onready:function(o){o=o.get("global"),window.krpano=o,t(o)}})})).then((t=>{t.method={hotspot:new y(t)},t.my={here:new C(t)},t.view.hlookat=123.4,t.view.vlookat=12.3,t.view.fov=120,t.actions.loadpano("/test/animated-hotspots/anihotspots.xml",null,"MERGE","BLEND(0.5)");var o=t.addlayer();o.name="flyingishere",o.type="container",o.align="right",o.edge="left",o.width=100,o.height=100;var e=t.addhotspot();e.name="haha",e.url="/images/cat.png",e.keep=!0,e.ath=0,e.atv=0,e.width=50,e.height=50,e.ondown="draghotspot();",e.layer=o,e.onclick=function(){t.actions.loadscene("scene2")},e.onout=function(){console.log(e)};const n=t.events.createItem("skin_plugin_vr");n.keep=!0,n.onnewscene=()=>{console.log("newnew!!")}}))}),0)})),(t,o)=>(u(),v("div",null,_))),__scopeId:"data-v-f612385a"};export{j as default};
