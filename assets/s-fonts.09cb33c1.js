import{f as w,g as _}from"./util.70a3f6d9.js";import{h as k,j as N,a as n,o as f,k as m,w as i,b as V,d,c as x,F as z,i as q,f as y,l as B}from"./index.f1e11b9a.js";const E={class:"cc"},D={__name:"s-fonts",props:["state"],setup(F){const c=F,o=k({isComputerFontsLoads:!1,familylist:w.map(e=>typeof e=="string"?{label:_(e),value:e,isLoad:!1}:e)});async function h(){const{state:e}=await navigator.permissions.query({name:"local-fonts"});console.log(e),e==="granted"&&p()}function L(e){var l=/[\u4E00-\u9FA5\uF900-\uFA2D]{1,}/;return l.test(e)}async function p(){const e=await queryLocalFonts();console.log("%c [ fonts ]-62","font-size:13px; background:pink; color:#bf2c9f;",e),e.length?(o.isComputerFontsLoads=!0,e.filter(t=>L(t.fullName)).forEach(t=>{o.familylist.map(s=>s.label).includes(t.fullName)||o.familylist.push({label:t.fullName,value:t.family,isLoad:!0})})):alert("\u8BF7\u914D\u7F6E\u672C\u673A\u5B57\u4F53\u8BBF\u95EE\u6743\u9650")}const b=e=>{const l=o.familylist.find(t=>t.value===e);l&&u(l)},g=e=>{const l=window.URL.createObjectURL(e.raw),t=_(e.name),a=o.familylist;a.find(s=>s.label!=t)&&a.push({value:l,label:t,isLoad:!1}),u(a.find(s=>s.label==t))};function u(e={}){if(e.isLoad)c.state.fontFamily=e.label;else{const l=document.fonts,t=new FontFace(e.label,"url("+e.value+")");t.load().then(a=>(l.add(t),c.state.fontFamily=e.label,e.isLoad=!0,e)).catch(a=>{alert("\u5B57\u4F53\u52A0\u8F7D\u9519\u8BEF\uFF01"),console.error(a)})}}return N(()=>{h(),u(o.familylist[0])}),(e,l)=>{const t=n("el-option"),a=n("el-select"),s=n("el-button"),v=n("el-upload"),C=n("el-form-item");return f(),m(C,{label:"\u5B57\u4F53\u8BBE\u7F6E"},{default:i(()=>[V("div",E,[d(a,{placeholder:"please select your zone",onChange:b,modelValue:c.state.fontFamily,"onUpdate:modelValue":l[0]||(l[0]=r=>c.state.fontFamily=r),size:"small"},{default:i(()=>[(f(!0),x(z,null,q(o.familylist,r=>(f(),m(t,{value:r.value,label:r.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]),d(v,{class:"upload-demo",action:"#","on-change":g,"http-request":()=>{},"file-list":[],"show-file-list":!1},{default:i(()=>[d(s,{size:"small",type:"primary",plain:""},{default:i(()=>[y("\u672C\u5730\u5B57\u4F53")]),_:1})]),_:1}),o.isComputerFontsLoads?B("",!0):(f(),m(s,{key:0,size:"small",type:"primary",plain:"",onClick:p},{default:i(()=>[y("\u672C\u673A\u5B57\u4F53")]),_:1}))])]),_:1})}}};export{D as _};
