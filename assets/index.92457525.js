import{_ as y,r as L,o as d,c as v,b as r,t as _,d as m,p as M,q as E,F as I,h as D,k as A,i as O}from"./index.ea485165.js";let f={};const j={align:"center",isMove:!0,x:0,y:0,iconId:"",url:"/images/love.png",data:[],callback:{},element:void 0};class S{constructor(t,e={}){this.krpano=t,this.option=e}register(t,e={}){return this.option={...this.option,...e},f[t]?f[t]:new N(t,this.option,this.krpano)}switch(t){this.krpano.hotspot.getArray().forEach(e=>{e.hotspot_type&&(e.visible=t)})}getHotspots(){return this.krpano.hotspot.getArray()}onremovepano(){for(var t in f)f[t].hotspotList=[]}finishData(t){return w(t)}finishDataList(t){for(var e in t)t[e]=w(t[e]);return t}}class N{constructor(t,e={},o){if(this.hotspotType=t,this.option=e,this.krpano=o,this.hotspotList=[],console.log("RegisterHotspot",this.krpano),!t)return console.error("\u5FC5\u987B\u8F93\u5165hotspotType");e.data&&this.init(e)}init(t){const e=t.data;t.data=void 0;for(var o in e)this.addHotspot($.extend(!0,{data:{}},t,e[o],{callback:{onAddHotspot:function(){}}}))}addHotspot(t={}){let e;return t.hotspotType=this.hotspotType,t=$.extend(!0,{},j,this.option,t),e=new R(this.krpano,t),this.hotspotList.push(e),e}getHotspot(t){var e=this.hotspotList,o;if(t){for(o in e)if(t==e[o].name)return e[o];return console.error("\u672A\u627E\u5230\u70ED\u70B9\uFF0Cname=",t)}return e}}class R{constructor(t,e={}){this.option=e,this.krpano=t,this.init()}init(){var t=this,e=this.option||{};console.log("opt",e);var o=this.krpano,a=e.ath||0,i=e.atv||0,n;if(!e.name)do this.name="flying_"+Math.random().toString(36).substring(2);while(o.get("hotspot["+this.name+"]"));if(!a&&a!==0&&!a&&a!==0){o.call("adjusthlookat(view.hlookat)"),a=o.view.hlookat,i=o.view.vlookat,o.spheretoscreen(o.view.hlookat,o.view.vlookat);var g=e.x||0,h=e.y||0;if(g||h){var u=o.screentosphere(g,h);a=u.x,i=u.y}}else a=a||0,i=i||0;typeof e.element=="function"?this.element=$(e.element(e.data)):this.element=$(e.element).clone(!0),this.data=e.data||{};var n=this.hotspot=o.addhotspot(this.name);if(n.keep=!0,n.align=e.align,n.ath=a,n.atv=i,n.hotspot_type=e.hotspotType,n.capture=!0,n.scale=.5,e.iconId?x(this,e.iconId):n.url=e.url,this.element){var C="layer_"+this.name,l=t.layer=o.addlayer(C);l.type="container",l.keep=!0,l.align="right",l.edge="left",$(l.sprite).append(this.element),$(l.sprite).delegate(":text, textarea","click mousedown mousedown focus",function(c){c.stopPropagation()}),$(l.sprite).delegate(".move","mousedown touchstart",function(c){n.ondown(),$(document).on("mouseup touchend",function(Q){n.onup(),$(document).off("mouseup touchend")})}),$(l.sprite).delegate(".click","click",function(c){return c.preventDefault(),n.onclick(),!1}),$(l.sprite).delegate(".click",{touchstart:function(c){n.isClick=!0},touchmove:function(c){n.isClick=!1},touchend:function(){n.isClick&&n.onclick()}}),l.bgcapture=!0,l.parent="hotspot["+this.name+"]"}this.option.isMove||(n.capture=!1),p("onLoaded",t),p("onAddHotspot",t),n.onclick=k("onClick",this),n.onover=k("onOver",this),n.onout=k("onOut",this),n.onhover=k("onHover",this),n.ondown="draghotspot();",n.onup=function(){n.zorder--,p("onUp",this),this.option.isMove&&(n.dragx!=o.mouse.stagex||n.dragy!=o.mouse.stagey)&&p("onMoveUpdate",this),n.pressed=!1,n.dragx=n.dragy=0}.bind(this)}setMove(t){this.option.isMove=!!t||!this.option.isMove}setKeep(t){this.hotspot.keep=!!t,this.layer.keep=!!t}update(t){t=t||{},t.style!==void 0&&x(this,t.style),t.url&&(this.hotspot.onloaded=void 0,this.hotspot.crop=void 0,this.hotspot.style="",this.hotspot.url=t.url),t.data&&(this.data=$.extend(!0,{},this.data,t.data)),p("onUpdatestyle",this)}remove(){console.log("remove this"),this.option.krpano.removelayer(this.layer.name),this.option.krpano.removehotspot(this.name),p("onRemove",this);for(var t in f){var e=f[t].hotspotList;for(var o in e)if(e[o]===this){e.splice(o,1);break}}}zorder(t){this.hotspot.zorder=t?101+100:101}save(t){p("onSaveHotspot",this)}getData(){var t=$.extend(!0,{},{data:this.data});return t.ath=this.hotspot.ath,t.atv=this.hotspot.atv,t.iconId=parseInt(this.hotspot.iconid),t.url=this.hotspot.url,t}getOldData(){var t=$.extend(!0,{},this.data);return t.ath=this.hotspot.ath,t.atv=this.hotspot.atv,t.iconId=parseInt(this.hotspot.iconid),t.url=this.hotspot.url,t}}function x(s,t){typeof t=="object"&&(t=t.name),typeof t=="string"?s.hotspot.loadstyle(t):typeof t=="number"?s.hotspot.loadstyle(t.name):this.yp("\u672A\u627E\u5230style=",t)}function k(s,t){var e=t.option.callback[s];if(e&&typeof e=="function")return e.bind(t,t.getData())}function p(s,t){var e=t.option.callback[s];e&&typeof e=="function"&&e.call(t,t.getData())}function w(s){return{data:s,atv:s.atv,ath:s.ath,iconId:s.iconId}}const T={class:"herewrap"},V={__name:"HelloWorld",props:{msg:String},setup(s){const t=L(0);return(e,o)=>(d(),v("main",T,[r("h1",null,"--"+_(s.msg)+"++",1),o[1]||(o[1]=r("p",null,[m(" Recommended IDE setup:"),r("a",{href:"https://code.visualstudio.com/",target:"_blank"},"VSCode"),m("+"),r("a",{href:"https://github.com/johnsoncodehk/volar",target:"_blank"},"Volar")],-1)),o[2]||(o[2]=r("p",null,[r("a",{href:"https://vitejs.dev/guide/features.html",target:"_blank"},"Vite Documentation"),m("|"),r("a",{href:"https://v3.vuejs.org/",target:"_blank"},"Vue 3 Documentation")],-1)),r("button",{type:"button",onClick:o[0]||(o[0]=a=>t.value++)},"count is: "+_(t.value),1),o[3]||(o[3]=r("p",null,[m(" Edit"),r("code",null,"components/HelloWorld.vue"),m("to test hot module replacement. ")],-1))]))}};var B=y(V,[["__scopeId","data-v-043edf38"]]),F="/images/love.png",U='<div class="herewrap">bababa</div>',b={};const G={align:"center",isMove:!0,url:F,iconId:!1,element:U,callback:{onClick:function(){console.log("this onClick",this)},onUp:function(t){console.log("this onUp",this)},onLoaded:function(){console.log("this onLoaded",this);var s=this.element[0];M({render:()=>E(B,{msg:"hello world"})}).mount(s)},onAddHotspot:function(){b=this,console.log("this currentHotspot",b)}}};class P{constructor(t,e={}){this.option={...G,...e},this.krpano=t,this.init()}init(t){const e=new S(this.krpano,this.option);this.option.data=e.finishDataList(t),this.here=e.register("here",this.option)}addHere(t={}){this.here.addHotspot(t)}onnewscene(){console.log("this is on new scene")}}const z={class:"logomenu"},W={key:0},q={__name:"LogoMenu",props:{title:{type:String,default:"\u521B\u610F\u753B\u623F"},menu:{type:Array,default:()=>[]}},setup(s){const t=L(!1);return(e,o)=>(d(),v("main",z,[r("h1",{onClick:o[0]||(o[0]=a=>t.value=!t.value)},_(s.title),1),t.value?(d(),v("dl",W,[(d(!0),v(I,null,D(s.menu,a=>(d(),v("dd",{key:a.name},_(a.name),1))),128))])):A("",!0)]))}};var K=y(q,[["__scopeId","data-v-eac928b2"]]);function H(s,t={}){const e=s.addlayer();return t={...{name:"layer",url:"/pano/logo1.png",align:"lefttop",keep:!0,scale:1,x:20,y:20},...t},Object.keys(t).forEach(a=>{e[a]=t[a]}),e}const J={__name:"index",setup(s){console.log("Heres",H);const t=()=>new Promise((e,o)=>{embedpano({xml:"/krpano/krpano.xml",target:"pano",html5:"only",onready:function(a){a=a.get("global"),window.krpano=a,e(a)}})});return O(async()=>{const e=await t();console.log("krpano",e);const o=new P(e,{});o.addHere({ath:20,atv:20,url:"/images/cat.png",isMove:!0,element:"<div>haha</div>",callback:{onClick:()=>{console.log("onClick");function h(){if(e){var u=`<krpano>
              <preview type="grid(cube,64,64,512,0xCCCCCC,0xF6F6F6,0x999999);" />
              <image><sphere url="/pano/2.jpeg" /></image>
              <view hlookat="0" vlookat="0" fov="100" distortion="0.0" />
              </krpano>`;e.call("loadxml("+escape(u)+", null, MERGE, BLEND(0.5));")}}h()}}}),console.log(o),e.actions.loadpano("/test/animated-hotspots/anihotspots.xml",null,"MERGE","BLEND(0.5)");let a=H(e,{name:"logo",url:"/pano/t.png",scale:1,onclick:""});M({render:()=>E(K,{menu:[{name:"\u6D77\u5929\u4E00\u8272",url:"/111"},{name:"\u6D77\u5E95\u63FD\u80DC",url:"/222"},{name:"\u95F2\u5EAD\u4FE1\u6B65",url:"/333"}]})}).mount(a.sprite);var i=e.addhotspot();i.name="haha11",i.url="/images/cat.png",i.keep=!0,i.ath=0,i.atv=0,i.width=50,i.height=50,i.ondown="draghotspot();",i.layer=a,i.onclick=function(){function h(){if(e){let u=`<krpano>
          <scene name="scene3" onstart="" autoload="false" >
            <preview type="grid(sphere,16,16,512,0x666666,0x333333,0x999999);" />
            <image><sphere url="/pano/3.jpeg" /></image>
            <view hlookat="0" vlookat="0" fov="100" distortion="0.0" />
          </scene>
        </krpano>`;e.call("loadxml("+escape(u)+", null, MERGE, BLEND(0.5));")}}h(),e.actions.loadscene("scene3")},i.onout=function(){};const g=e.events.createItem("skin_plugin_vr");g.keep=!0,g.onnewscene=()=>{console.log("newnew!!")}}),(e,o)=>(d(),v("div",null,o[0]||(o[0]=[r("div",{id:"pano"},null,-1)])))}};var Y=y(J,[["__scopeId","data-v-79c8612b"]]);export{Y as default};
